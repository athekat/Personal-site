<!DOCTYPE html>
<html
  dir="ltr"
  lang="en"
  data-theme=""
  
    class="html theme--light"
  
><head>
  <title>
    .:: Alan Cortez
        |
        Skills Assessment - Windows Event Logs &amp; Finding Evil - HackTheBox.
      

    

  </title>

  
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.92.2" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content=".:: Alan Cortez" />
  <meta
    name="description"
    content="Bits of &lt;u&gt;&lt;a href=&#39;https://alan.com.ar/tags/walkthrough/&#39;&gt;Cyber Security&lt;/a&gt;&lt;/u&gt;, &lt;u&gt;&lt;a href=&#39;https://alan.com.ar/tags/scripts/&#39;&gt;Coding&lt;/a&gt;&lt;/u&gt;, &lt;u&gt;&lt;a href=&#39;https://alan.com.ar/tags/age-of-empires-ii/&#39;&gt;Age Of Empires II&lt;/a&gt;&lt;/u&gt; and &lt;u&gt;&lt;a href=&#39;https://alan.com.ar/tags/project/&#39;&gt;small projects&lt;/a&gt;&lt;/u&gt;. 
 Constantly looking for ways to improve my skills and knowledge. I am a fast learner and always ready to take on new challenges. I am currently deepening my knowledge in Python language."
  />
  
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.b8f0c37a64ae91d6534f2e290cc4c4b2e913feb9e7006d81a6886d55863e9f00.css"
      integrity="sha256-uPDDemSukdZTTy4pDMTEsukT/rnnAG2BpohtVYY&#43;nwA="
      crossorigin="anonymous"
      type="text/css"
    />
  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css"
    integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA="
    crossorigin="anonymous"
    type="text/css"
  />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css"
    integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css"
    integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css"
    integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css"
    integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="https://alan.com.ar/post/windowseventlogshtb/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.46e6a54097480084f8f52c20ca1aa7425b4fad17029a887fd4017b12e311a72d.js"
    integrity="sha256-RualQJdIAIT49SwgyhqnQltPrRcCmoh/1AF7EuMRpy0="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.4c31f3cf7e8e609c897dba88aecac0e8db1ebb4e5c841d3f9ffb01d463973678.js"
      integrity="sha256-TDHzz36OYJyJfbqIrsrA6Nseu05chB0/n/sB1GOXNng="
      crossorigin="anonymous"
    ></script>
  

  


  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://alan.com.ar/images/site-feature-image.png"/>

<meta name="twitter:title" content="Skills Assessment - Windows Event Logs &amp; Finding Evil - HackTheBox."/>
<meta name="twitter:description" content="This module covers the exploration of Windows Event Logs and their significance in uncovering suspicious activities."/>



  
  <meta property="og:title" content="Skills Assessment - Windows Event Logs &amp; Finding Evil - HackTheBox." />
<meta property="og:description" content="This module covers the exploration of Windows Event Logs and their significance in uncovering suspicious activities." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://alan.com.ar/post/windowseventlogshtb/" /><meta property="og:image" content="https://alan.com.ar/images/site-feature-image.png"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2024-09-15T00:24:52-03:00" />
<meta property="article:modified_time" content="2024-09-15T00:24:52-03:00" /><meta property="og:site_name" content="Alan Cortez" />




  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "post",
        "name": "Skills Assessment - Windows Event Logs \u0026 Finding Evil - HackTheBox.",
        "headline": "Skills Assessment - Windows Event Logs \u0026 Finding Evil - HackTheBox.",
        "alternativeHeadline": "",
        "description": "
      
        This module covers the exploration of Windows Event Logs and their significance in uncovering suspicious activities.


      


    ",
        "inLanguage": "en-us",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/alan.com.ar\/post\/windowseventlogshtb\/"
        },
        "author" : {
            "@type": "Person",
            "name": ".:: Alan Cortez"
        },
        "creator" : {
            "@type": "Person",
            "name": ".:: Alan Cortez"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": ".:: Alan Cortez"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": ".:: Alan Cortez"
        },
        "copyrightYear" : "2024",
        "dateCreated": "2024-09-15T00:24:52.00Z",
        "datePublished": "2024-09-15T00:24:52.00Z",
        "dateModified": "2024-09-15T00:24:52.00Z",
        "publisher":{
            "@type":"Organization",
            "name": ".:: Alan Cortez",
            "url": "https://alan.com.ar",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/alan.com.ar\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
        
        "https://alan.com.ar/images/site-feature-image.png"


      
      ]

    ,
        "url" : "https:\/\/alan.com.ar\/post\/windowseventlogshtb\/",
        "wordCount" : "561",
        "genre" : [ ],
        "keywords" : [ 
      
      "Windows"

    
      
        ,

      
      "HackTheBox"

    
      
        ,

      
      "Walkthrough"

    
      
        ,

      
      "SOC"

    ]
    }
  </script>


</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      ><script src="https://unpkg.com/typeit@8.7.1/dist/index.umd.js"></script>

<div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/photoglitch.gif"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/" class="typewriter"></a>
          

          <script> 
          const typeit2 = new TypeIt(".typewriter", {
            cursorChar: "_"  ,
            speed: 25});
          
          typeit2.type("> ALAN CORTEZ ");

          typeit2.go();
          </script>
      </div>
      
      <div class="sidebar__introduction-description">
        <p>Bits of <u><a href='https://alan.com.ar/tags/walkthrough/'>Cyber Security</a></u>, <u><a href='https://alan.com.ar/tags/scripts/'>Coding</a></u>, <u><a href='https://alan.com.ar/tags/age-of-empires-ii/'>Age Of Empires II</a></u> and <u><a href='https://alan.com.ar/tags/project/'>small projects</a></u>. <br /> Constantly looking for ways to improve my skills and knowledge. I am a fast learner and always ready to take on new challenges. I am currently deepening my knowledge in Python language.</p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">

          <a
            href="https://github.com/athekat/"
            target="_blank"
            rel="noopener me"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>

      
        <li class="sidebar__list-item">

          <a
            href="https://www.linkedin.com/in/alan-ian-cortez/"
            target="_blank"
            rel="noopener me"
            aria-label="Linkedin"
            title="Linkedin"
          >
            <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
          </a>
        </li>

      
        <li class="sidebar__list-item">

          <a
            href="mailto:contactme@alan.com.ar"
            target="_blank"
            rel="noopener me"
            aria-label="e-mail"
            title="e-mail"
          >
            <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
          </a>
        </li>

      
      <br><br>
      <a href="https://tryhackme.com/r/p/athekat"><img src="https://tryhackme-badges.s3.amazonaws.com/athekat.png" alt="TryHackMe Badge" /></a>
    </ul>
  </div>
</div>
</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/"
              
              title=""
              >Home</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/post/"
              
              title=""
              >Posts</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/portfolio/"
              
              title=""
              >Projects</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      <h1>Skills Assessment - Windows Event Logs &amp; Finding Evil - HackTheBox.</h1>
      
        <ul class="post__meta">
          <li class="post__meta-item">
            <em class="fas fa-calendar-day post__meta-icon"></em>
            <span class="post__meta-text"
              >
                
                  15/9/2024
                

              
            </span>
          </li>
          <li class="post__meta-item">
            <em class="fas fa-stopwatch post__meta-icon"></em>
            <span class="post__meta-text">3-minute read</span>
          </li>
        </ul>
      <blockquote>
<p>This module covers the exploration of Windows Event Logs and their significance in uncovering suspicious activities. Throughout the course, we delve into the anatomy of Windows Event Logs and highlight the logs that hold the most valuable information for investigations. The module also focuses on utilizing Sysmon and Event Logs for detecting and analyzing malicious behavior. Additionally, we delve into Event Tracing for Windows (ETW), explaining its architecture and components, and provide ETW-based detection examples. To streamline the analysis process, we introduce the powerful Get-WinEvent cmdlet.</p>
</blockquote>
<blockquote>
<p><a href="https://academy.hackthebox.com/module/details/216">Link to the module</a></p>
</blockquote>
<ol>
<li>By examining the logs located in the &ldquo;C:\Logs\DLLHijack&rdquo; directory, determine the process responsible for executing a DLL hijacking attack. Enter the process name as your answer. Answer format: _.exe</li>
</ol>
<p>Using Get-WinEvent, I attempted to filter for events related to DLL hijacking attacks. While this might not be the most efficient method, I recalled that DLLs involved in such attacks are often unsigned. Therefore, I searched for events with <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#events">ID</a> 7 AND those with the message &ldquo;signed: false&rdquo;.</p>
<p>I run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Get-WinEvent -Path <span class="s1">&#39;C:\Logs\DLLHijack\*&#39;</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.ID -like <span class="s2">&#34;7&#34;</span><span class="o">}</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.Message -like <span class="s2">&#34;*signed: false*&#34;</span><span class="o">}</span> <span class="p">|</span> Select-Object TimeCreated, ID, ProviderName, LevelDisplayName, Message 
</code></pre></div><p>Only got 2 results and one of those was the correct answer.</p>
<ol start="2">
<li>By examining the logs located in the &ldquo;C:\Logs\PowershellExec&rdquo; directory, determine the process that executed unmanaged PowerShell code. Enter the process name as your answer. Answer format: _.exe</li>
</ol>
<p>As per the guide, the presence of &ldquo;Microsoft .NET Runtime&hellip;&rdquo;, clr.dll, and clrjit.dll in processes that typically don&rsquo;t require them is indicative of potential execute-assembly or unmanaged PowerShell injection attacks. These DLLs are typically used for executing C# code. Therefore, I searched for events containing &ldquo;clr.dll&rdquo;. The initial results highlighted a suspicious executable file that should not have access to this DLL.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Get-WinEvent -Path <span class="s1">&#39;C:\Logs\PowershellExec\*&#39;</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.ID -like <span class="s2">&#34;7&#34;</span><span class="o">}</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.Message -like <span class="s2">&#34;*clr.dll*&#34;</span><span class="o">}</span> <span class="p">|</span> Select-Object TimeCreated, ID, ProviderName, LevelDisplayName, Message
</code></pre></div><ol start="3">
<li>By examining the logs located in the &ldquo;C:\Logs\PowershellExec&rdquo; directory, determine the process that injected into the process that executed unmanaged PowerShell code. Enter the process name as your answer. Answer format: _.exe</li>
</ol>
<p>For this specific scenario, I focused on Calculator.exe and filtered events with <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#events">ID</a> 8, indicating a CreateRemoteThread operation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Get-WinEvent -Path <span class="s1">&#39;C:\Logs\PowershellExec\*&#39;</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.ID -like <span class="s2">&#34;8&#34;</span><span class="o">}</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.Message -like <span class="s2">&#34;*Calculator.exe*&#34;</span><span class="o">}</span> <span class="p">|</span> Select-Object TimeCreated, ID, ProviderName, LevelDisplayName, Message
</code></pre></div><ol start="4">
<li>By examining the logs located in the &ldquo;C:\Logs\Dump&rdquo; directory, determine the process that performed an LSASS dump. Enter the process name as your answer. Answer format: _.exe</li>
</ol>
<p>I filtered for events with <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#events">ID</a> 10 (ProcessAccess) and searched for entries targeting lsass.exe. While there were multiple results, only one was initiated by a suspicious executable file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Get-WinEvent -Path <span class="s1">&#39;C:\Logs\Dump\*&#39;</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.ID -like <span class="s2">&#34;10&#34;</span><span class="o">}</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.Message -like <span class="s2">&#34;*TargetImage*lsass.exe*&#34;</span><span class="o">}</span> <span class="p">|</span> Select-Object TimeCreated, ID, ProviderName, LevelDisplayName, Message
</code></pre></div><ol start="5">
<li>By examining the logs located in the &ldquo;C:\Logs\Dump&rdquo; directory, determine if an ill-intended login took place after the LSASS dump. Answer format: Yes or No</li>
</ol>
<p>I searched for events with ID 4624 (which indicates a successful account login), but found no relevant entries.</p>
<ol start="6">
<li>By examining the logs located in the &ldquo;C:\Logs\StrangePPID&rdquo; directory, determine a process that was used to temporarily execute code based on a strange parent-child relationship. Enter the process name as your answer. Answer format: _.exe</li>
</ol>
<p>Finally, I filtered for events with <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#events">ID</a> 1 (Process creation). There were limited results, and only one of them appeared suspicious.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Get-WinEvent -Path <span class="s1">&#39;C:\Logs\StrangePPID\*&#39;</span> <span class="p">|</span> Where-Object<span class="o">{</span><span class="nv">$_</span>.ID -like <span class="s2">&#34;1&#34;</span><span class="o">}</span> <span class="p">|</span> Select-Object TimeCreated, ID, ProviderName, LevelDisplayName, Message
</code></pre></div>

  <h3>Related Posts</h3>
  <ul>
    
      <li><a href="/post/valley/">Walkthrough: Valley CTF - TryHackMe.</a></li>
    
      <li><a href="/post/intermediatenmap/">Walkthrough: Intermediate Nmap - TryHackMe.</a></li>
    
      <li><a href="/post/picklerickctf/">Walkthrough: Pickle Rick CTF - TryHackMe.</a></li>
    
  </ul>

</div>
    <div class="post__footer">
      

      
        <span><a class="tag" href="/tags/windows/">Windows</a><a class="tag" href="/tags/hackthebox/">HackTheBox</a><a class="tag" href="/tags/walkthrough/">Walkthrough</a><a class="tag" href="/tags/soc/">SOC</a></span>


      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">

</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.fae9ac8895995fe91958b3954be11e96025824a04770726a3531e119ddd2d576.js"
    integrity="sha256-&#43;umsiJWZX&#43;kZWLOVS&#43;EelgJYJKBHcHJqNTHhGd3S1XY="
    crossorigin="anonymous"
  ></script></body>
</html>
